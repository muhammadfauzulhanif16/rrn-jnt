import{i,_ as G,v as Y,f as Z,u as $,R as K,j as o,W as O,P as E,B as Q}from"./app-C_DxjwWY.js";import{m as c,A as U}from"./mapbox-gl-ODp7-qlc.js";import{M as V}from"./mapbox-gl-geocoder-ANuEFYLn.js";import{b as J,A as X,S as w,i as q}from"./AppLayout-HsdZrY7g.js";import{G as p}from"./Grid-yslJ5uJl.js";import{T as R,D as P}from"./Title-gs-8KFVt.js";import{T as _}from"./TextInput-C56idysm.js";import{I as ee}from"./IconId-l6UD1ZAi.js";import{N as te}from"./NumberInput-iHYt0y-i.js";import{I as M,F as re}from"./Flex-1RADBffJ.js";import{I as ae,a as ne}from"./IconPassword-hBsFQ8i-.js";import{P as oe}from"./PasswordInput-6zu8UkLk.js";import{I as ie,K as se}from"./IconCornerDownLeft-R6alCY5D.js";import"./react-number-format.es-35aNL67y.js";import"./clamp-153t9aX1.js";var le={};function ue(){return typeof process<"u"&&le?"production":"development"}var de=i.useLayoutEffect,ce=function(r){var n=i.useRef(r);return de(function(){n.current=r}),n},T=function(r,n){if(typeof r=="function"){r(n);return}r.current=n},he=function(r,n){var e=i.useRef();return i.useCallback(function(t){r.current=t,e.current&&T(e.current,null),e.current=n,n&&T(n,t)},[n])},I={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},ge=function(r){Object.keys(I).forEach(function(n){r.style.setProperty(n,I[n],"important")})},H=ge,s=null,N=function(r,n){var e=r.scrollHeight;return n.sizingStyle.boxSizing==="border-box"?e+n.borderSize:e-n.paddingSize};function fe(a,r,n,e){n===void 0&&(n=1),e===void 0&&(e=1/0),s||(s=document.createElement("textarea"),s.setAttribute("tabindex","-1"),s.setAttribute("aria-hidden","true"),H(s)),s.parentNode===null&&document.body.appendChild(s);var t=a.paddingSize,d=a.borderSize,l=a.sizingStyle,g=l.boxSizing;Object.keys(l).forEach(function(x){var b=x;s.style[b]=l[b]}),H(s),s.value=r;var u=N(s,a);s.value=r,u=N(s,a),s.value="x";var h=s.scrollHeight-t,f=h*n;g==="border-box"&&(f=f+t+d),u=Math.max(f,u);var v=h*e;return g==="border-box"&&(v=v+t+d),u=Math.min(v,u),[u,h]}var A=function(){},me=function(r,n){return r.reduce(function(e,t){return e[t]=n[t],e},{})},pe=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],ve=!!document.documentElement.currentStyle,xe=function(r){var n=window.getComputedStyle(r);if(n===null)return null;var e=me(pe,n),t=e.boxSizing;if(t==="")return null;ve&&t==="border-box"&&(e.width=parseFloat(e.width)+parseFloat(e.borderRightWidth)+parseFloat(e.borderLeftWidth)+parseFloat(e.paddingRight)+parseFloat(e.paddingLeft)+"px");var d=parseFloat(e.paddingBottom)+parseFloat(e.paddingTop),l=parseFloat(e.borderBottomWidth)+parseFloat(e.borderTopWidth);return{sizingStyle:e,paddingSize:d,borderSize:l}},be=xe;function W(a,r,n){var e=ce(n);i.useLayoutEffect(function(){var t=function(l){return e.current(l)};if(a)return a.addEventListener(r,t),function(){return a.removeEventListener(r,t)}},[])}var Se=function(r){W(window,"resize",r)},ye=function(r){W(document.fonts,"loadingdone",r)},je=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Ce=function(r,n){var e=r.cacheMeasurements,t=r.maxRows,d=r.minRows,l=r.onChange,g=l===void 0?A:l,u=r.onHeightChange,h=u===void 0?A:u,f=G(r,je),v=f.value!==void 0,x=i.useRef(null),b=he(x,n),z=i.useRef(0),j=i.useRef(),S=function(){var m=x.current,C=e&&j.current?j.current:be(m);if(C){j.current=C;var L=fe(C,m.value||m.placeholder||"x",d,t),y=L[0],D=L[1];z.current!==y&&(z.current=y,m.style.setProperty("height",y+"px","important"),h(y,{rowHeight:D}))}},B=function(m){v||S(),g(m)};return i.useLayoutEffect(S),Se(S),ye(S),i.createElement("textarea",Y({},f,{onChange:B,ref:b}))},we=i.forwardRef(Ce);const ke={},k=Z((a,r)=>{const{autosize:n,maxRows:e,minRows:t,__staticSelector:d,resize:l,...g}=$("Textarea",ke,a),u=n&&ue()!=="test",h=u?{maxRows:e,minRows:t}:{};return K.createElement(M,{component:u?we:"textarea",ref:r,...g,__staticSelector:d||"Textarea",multiline:!0,"data-no-overflow":n&&e===void 0||void 0,__vars:{"--input-resize":l},...h})});k.classes=M.classes;k.displayName="@mantine/core/Textarea";var ze=J("phone","IconPhone",[["path",{d:"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2",key:"svg-0"}]]);const Le=a=>{c.accessToken="pk.eyJ1IjoiZWZ6ZWRlbDE2IiwiYSI6ImNscnhiN2NzYjBiNnQycW51Zmx3ajVjeG8ifQ.EM_vVs0ALH-nDkRQb-WSiA";const r=i.useRef(null),n=i.useRef(null);return i.useEffect(()=>{if(!n.current)if(c.supported()){n.current=new c.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v12",center:[a.currentPosition.longitude,a.currentPosition.latitude],zoom:16}).addControl(new V({accessToken:c.accessToken,marker:!1,mapboxgl:c}).on("result",function(t){a.setCurrentPosition({longitude:t.result.center[0],latitude:t.result.center[1]}),e.setLngLat([t.result.center[0],t.result.center[1]])})).addControl(new c.FullscreenControl,"bottom-right").addControl(new c.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})).addControl(new c.NavigationControl,"top-left").addControl(new c.ScaleControl);const e=new c.Marker({draggable:!0}).setLngLat([a.currentPosition.longitude,a.currentPosition.latitude]).on("dragend",function(t){a.setCurrentPosition({longitude:t.target.getLngLat().lng,latitude:t.target.getLngLat().lat})}).addTo(n.current);navigator.geolocation.getCurrentPosition(t=>{a.setCurrentPosition({longitude:t.coords.longitude,latitude:t.coords.latitude}),(a.currentPosition.longitude===0||a.currentPosition.latitude===0)&&(n.current.flyTo({center:[t.coords.longitude,t.coords.latitude]}),e.setLngLat([t.coords.longitude,t.coords.latitude]))})}else{alert("Your browser does not support Mapbox GL");return}}),o.jsx("div",{children:o.jsx("div",{ref:r,style:{width:"100%",height:"100%",borderRadius:"20px"}})})},Ye=a=>{const[r,n]=i.useState({longitude:a.auth.user.longitude||0,latitude:a.auth.user.latitude||0});console.log(r),console.log(r);const e=O({full_name:a.auth.user.full_name||"",phone_number:a.auth.user.phone_number||"",address:a.auth.user.address||"",longitude:r.longitude,latitude:r.latitude,username:a.auth.user.username||"",password:a.auth.user.password||""});return i.useEffect(()=>{e.setData(t=>({...t,longitude:r.longitude,latitude:r.latitude}))},[r]),console.log(e.data),o.jsx(X,{title:"Pengaturan",auth:a.auth.user,meta:a.meta,children:o.jsx("form",{onSubmit:t=>{t.preventDefault(),!e.hasErrors&&e.patch(route("profile.update"))},children:o.jsxs(w,{children:[o.jsxs(p,{children:[o.jsx(p.Col,{span:{base:12,sm:4},children:o.jsx(R,{order:3,c:"gray.9",children:"Profil"})}),o.jsx(p.Col,{span:{base:12,sm:8},children:o.jsx(E,{p:32,radius:20,withBorder:!0,children:o.jsxs(w,{gap:24,children:[o.jsx(_,{label:"Nama Lengkap",placeholder:"Masukkan nama lengkap",variant:"filled",radius:"xl",leftSection:o.jsx(ee,{size:16}),value:e.data.full_name,disabled:a.auth.user.role==="kurir",styles:{label:{marginBottom:8,color:"#212529"},input:{height:40}},onChange:t=>{e.setData("full_name",t.target.value),t.target.value?e.clearErrors("full_name"):e.setError({full_name:"Nama lengkap tidak boleh kosong."})},error:e.errors.full_name}),a.auth.user.role==="pelanggan"&&o.jsxs(o.Fragment,{children:[o.jsx(te,{label:"Nomor Telepon",placeholder:"Masukkan nomor telepon",leftSection:o.jsx(ze,{size:16}),hideControls:!0,prefix:"+62 ",allowNegative:!1,allowDecimal:!1,variant:"filled",radius:"xl",styles:{label:{marginBottom:8,color:"#212529"},input:{height:40}},value:e.data.phone_number,onChange:t=>{e.setData("phone_number",t),t?e.clearErrors("phone_number"):e.setError({phone_number:"Nomor telepon boleh kosong."})},error:e.errors.phone_number}),o.jsx(k,{label:"Alamat",placeholder:"Masukkan alamat",variant:"filled",radius:"xl",leftSection:o.jsx(q,{size:16}),value:e.data.address,onChange:t=>{e.setData("address",t.target.value),t.target.value?e.clearErrors("address"):e.setError({address:"Alamat telepon boleh kosong."})},autosize:!0,styles:{label:{marginBottom:8,color:"#212529"},input:{height:40}},error:e.errors.address}),o.jsx(U,{ratio:16/9,children:o.jsx(Le,{currentPosition:r,setCurrentPosition:n})})]})]})})})]}),o.jsx(P,{my:32}),o.jsxs(p,{children:[o.jsx(p.Col,{span:{base:12,sm:4},children:o.jsx(R,{order:3,c:"gray.9",children:"Akun"})}),o.jsx(p.Col,{span:{base:12,sm:8},children:o.jsx(E,{p:32,radius:20,withBorder:!0,children:o.jsxs(w,{gap:24,children:[o.jsx(_,{label:"Nama Pengguna",placeholder:"Masukkan nama pengguna",variant:"filled",radius:"xl",leftSection:o.jsx(ae,{size:16}),onChange:t=>{e.setData("username",t.target.value.toLowerCase()),t.target.value?e.clearErrors("username"):e.setError({username:"Nama pengguna tidak boleh kosong."}),a.users.some(({username:d})=>d===t.target.value.toLowerCase())&&e.setError({username:"Nama pengguna sudah digunakan."})},styles:{label:{marginBottom:8,color:"#212529"},input:{height:40}},value:e.data.username,error:e.errors.username}),o.jsx(oe,{label:"Kata Sandi",description:"Isi jika ingin mengubah kata sandi",placeholder:"Masukkan kata sandi",variant:"filled",radius:"xl",leftSection:o.jsx(ne,{size:16}),onChange:t=>e.setData("password",t.target.value),styles:{description:{marginBottom:16},label:{color:"#212529"},input:{height:40}},error:e.errors.password})]})})})]}),o.jsx(P,{my:32}),o.jsx(re,{justify:"flex-end",children:o.jsx(Q,{h:40,leftSection:o.jsx(ie,{}),rightSection:o.jsx(se,{children:"Enter"}),disabled:e.hasErrors,loading:e.processing,radius:"xl",color:"red.5",type:"submit",children:"Simpan"})})]})})})};export{Ye as default};
